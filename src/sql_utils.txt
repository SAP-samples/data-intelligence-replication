#
#  SPDX-FileCopyrightText: 2021 Thorsten Hapke <thorsten.hapke@sap.com>
#
#  SPDX-License-Identifier: Apache-2.0
#

# Create Table Repos
CREATE COLUMN TABLE "REPLICATION"."TABLE_REPOS"(
	"TABLE_NAME" NVARCHAR(100),
	PRIMARY KEY (
		"TABLE_NAME"
	)
)

#Create Test Table
CREATE COLUMN TABLE "REPLICATION"."TEST_TABLE_0"(
	"INDEX" BIGINT,
	"NUMBER" BIGINT,
	"DATETIME" LONGDATE,
	"DIREPL_PID" BIGINT,
	"DIREPL_UPDATED" LONGDATE,
	"DIREPL_STATUS" NVARCHAR(1),
	"DIREPL_TYPE" NVARCHAR(1),
	PRIMARY KEY (
		"INDEX",
		"DIREPL_UPDATED"
	)
)


# set status to 'W'
UPDATE REPLICATION.TEST_TABLE_0 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_1 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_2 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_3 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_4 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_5 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_6 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_7 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_8 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_9 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_10 SET "DIREPL_STATUS" = 'W';
UPDATE REPLICATION.TEST_TABLE_11 SET "DIREPL_STATUS" = 'W';

# Remove Table
DROP TABLE REPLICATION.TEST_TABLE_0;
DROP TABLE REPLICATION.TEST_TABLE_1;
DROP TABLE REPLICATION.TEST_TABLE_2;
DROP TABLE REPLICATION.TEST_TABLE_3;
DROP TABLE REPLICATION.TEST_TABLE_4;
DROP TABLE REPLICATION.TEST_TABLE_5;
DROP TABLE REPLICATION.TEST_TABLE_6;
DROP TABLE REPLICATION.TEST_TABLE_7;
DROP TABLE REPLICATION.TEST_TABLE_8;
DROP TABLE REPLICATION.TEST_TABLE_9;
DROP TABLE REPLICATION.TEST_TABLE_10;
DROP TABLE REPLICATION.TEST_TABLE_11;

# Delete Data
TRUNCATE TABLE REPLICATION.TEST_TABLE_0;
TRUNCATE TABLE REPLICATION.TEST_TABLE_1;
TRUNCATE TABLE REPLICATION.TEST_TABLE_2;
TRUNCATE TABLE REPLICATION.TEST_TABLE_3;
TRUNCATE TABLE REPLICATION.TEST_TABLE_4;
TRUNCATE TABLE REPLICATION.TEST_TABLE_5;
TRUNCATE TABLE REPLICATION.TEST_TABLE_6;
TRUNCATE TABLE REPLICATION.TEST_TABLE_7;
TRUNCATE TABLE REPLICATION.TEST_TABLE_8;
TRUNCATE TABLE REPLICATION.TEST_TABLE_9;
TRUNCATE TABLE REPLICATION.TEST_TABLE_10;
TRUNCATE TABLE REPLICATION.TEST_TABLE_11;
